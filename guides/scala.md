---
layout: page
permalink: /guides/scala/
title: "SBOM Generation Guide for Scala - sbt"
description: "Learn how to generate Software Bill of Materials for Scala projects. Complete guide with build.sbt examples, cross-compilation, and dependency management."
section: guides
---

## Source vs Build SBOMs

Scala's primary build tool, sbt (Scala Build Tool), manages dependencies through `build.sbt`. Unlike some other ecosystems, sbt doesn't use a traditional lockfile by default, which creates challenges for SBOM generation.

- **Source SBOMs** are generated from `build.sbt` and resolved dependencies
- **Build SBOMs** analyze compiled artifacts in the `target/` directory

For accurate SBOMs, you need to resolve dependencies first using sbt plugins.

## Dependency Declaration

### build.sbt

Dependencies are declared in `build.sbt`:

```scala
name := "my-app"
version := "1.0.0"
scalaVersion := "3.3.1"

libraryDependencies ++= Seq(
  "org.typelevel" %% "cats-core" % "2.10.0",
  "io.circe" %% "circe-core" % "0.14.6",
  "io.circe" %% "circe-generic" % "0.14.6",
  "io.circe" %% "circe-parser" % "0.14.6",
  "org.http4s" %% "http4s-ember-server" % "0.23.24",
  "org.http4s" %% "http4s-circe" % "0.23.24",
  "org.http4s" %% "http4s-dsl" % "0.23.24",

  // Test dependencies
  "org.scalatest" %% "scalatest" % "3.2.17" % Test,
  "org.scalamock" %% "scalamock" % "5.2.0" % Test
)
```

### Understanding %% vs %

```scala
// %% appends Scala version (cross-compiled)
"org.typelevel" %% "cats-core" % "2.10.0"
// Resolves to: cats-core_3 or cats-core_2.13

// % uses artifact as-is (Java libraries)
"org.postgresql" % "postgresql" % "42.7.0"
```

## Cross-Compilation

Scala libraries are often published for multiple Scala versions:

```scala
// project/build.properties
sbt.version=1.9.8

// build.sbt
crossScalaVersions := Seq("2.13.12", "3.3.1")
scalaVersion := "3.3.1"
```

This means dependencies resolve to different artifacts based on Scala version:
- `cats-core_2.13` for Scala 2.13
- `cats-core_3` for Scala 3

Your SBOM should reflect the specific Scala version used for your build.

## sbt-dependency-graph Plugin

For detailed dependency analysis, use the sbt-dependency-graph plugin:

```scala
// project/plugins.sbt
addSbtPlugin("net.virtual-void" % "sbt-dependency-graph" % "0.10.0-RC1")
```

Generate dependency information:

```bash
# ASCII tree
sbt dependencyTree

# Export to file
sbt "dependencyList" > dependencies.txt

# Generate DOT graph
sbt dependencyDot
```

## sbt-dependency-lock Plugin

For lockfile-based reproducibility:

```scala
// project/plugins.sbt
addSbtPlugin("io.github.davidgregory084" % "sbt-dependency-lock" % "1.1.0")
```

```bash
# Generate lockfile
sbt dependencyLockWrite

# Verify against lockfile
sbt dependencyLockCheck
```

This creates `build.sbt.lock`:

```
# This file was generated by sbt-dependency-lock
org.scala-lang:scala-library:2.13.12
org.typelevel:cats-core_2.13:2.10.0
org.typelevel:cats-kernel_2.13:2.10.0
```

## Generating an SBOM

### Using cdxgen (Recommended)

[cdxgen](https://github.com/CycloneDX/cdxgen) has Scala/sbt support:

```bash
# Install cdxgen
npm install -g @cyclonedx/cdxgen

# Generate SBOM (requires sbt to be available)
cdxgen -t sbt -o sbom.cdx.json
```

### Using sbt-bom Plugin

Generate CycloneDX directly from sbt:

```scala
// project/plugins.sbt
addSbtPlugin("com.github.sbt" % "sbt-cyclonedx" % "0.1.0")
```

```bash
sbt makeBom
```

### Manual Export with sbt-dependency-graph

Export dependencies and convert to SBOM:

```bash
# Export as JSON-like format
sbt "print dependencyList" > deps.txt

# Convert to SBOM (custom script needed)
```

### Using Syft

[Syft](https://github.com/anchore/syft) has limited sbt support but can analyze built JARs:

```bash
# Build first
sbt package

# Analyze JAR
syft target/scala-3.3.1/my-app_3-1.0.0.jar -o cyclonedx-json=sbom.cdx.json
```

## Automate with sbomify GitHub Action

The [sbomify GitHub Action](https://github.com/sbomify/github-action/) supports Scala:

```yaml
---
name: Generate SBOM for Scala Project

on: [push]

jobs:
  sbom:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up JDK
        uses: actions/setup-java@v4
        with:
          java-version: '21'
          distribution: 'temurin'

      - name: Set up sbt
        uses: sbt/setup-sbt@v1

      - name: Resolve dependencies
        run: sbt update

      - name: Generate and Upload SBOM
        uses: sbomify/github-action@master
        env:
          TOKEN: ${{ secrets.SBOMIFY_TOKEN }}
          COMPONENT_ID: 'my-scala-component'
          LOCK_FILE: 'build.sbt'
          OUTPUT_FILE: 'sbom.cdx.json'
          ENRICH: true
          UPLOAD: true
```

## GitLab and Other CI/CD

For GitLab CI:

```yaml
generate-sbom:
  image: hseeberger/scala-sbt:17.0.2_1.9.8_3.3.1
  stage: build
  script:
    - sbt update
    - npm install -g @cyclonedx/cdxgen
    - cdxgen -t sbt -o sbom.cdx.json
  artifacts:
    paths:
      - sbom.cdx.json
```

## Multi-Module Projects

Scala projects often have multiple modules:

```scala
// build.sbt
lazy val root = (project in file("."))
  .aggregate(core, api, web)

lazy val core = (project in file("core"))
  .settings(
    libraryDependencies ++= Seq(
      "org.typelevel" %% "cats-core" % "2.10.0"
    )
  )

lazy val api = (project in file("api"))
  .dependsOn(core)
  .settings(
    libraryDependencies ++= Seq(
      "io.circe" %% "circe-core" % "0.14.6"
    )
  )

lazy val web = (project in file("web"))
  .dependsOn(api)
  .settings(
    libraryDependencies ++= Seq(
      "org.http4s" %% "http4s-ember-server" % "0.23.24"
    )
  )
```

Generate SBOMs per module or aggregate:

```bash
# All modules
sbt dependencyTree

# Specific module
sbt "project api" dependencyTree
```

## Handling Special Cases

### Resolvers and Private Repositories

```scala
resolvers ++= Seq(
  "Sonatype Releases" at "https://oss.sonatype.org/content/repositories/releases/",
  "Private Repo" at "https://repo.example.com/maven2"
)

credentials += Credentials(Path.userHome / ".sbt" / ".credentials")
```

### Exclusions and Overrides

```scala
libraryDependencies ++= Seq(
  "org.example" %% "library" % "1.0.0" exclude("commons-logging", "commons-logging")
)

// Force specific version
dependencyOverrides += "com.google.guava" % "guava" % "32.1.3-jre"
```

### Provided Dependencies

```scala
libraryDependencies ++= Seq(
  "javax.servlet" % "javax.servlet-api" % "4.0.1" % Provided
)
```

Provided dependencies should be documented but noted as provided by the runtime environment.

### Compile-time Only

```scala
libraryDependencies ++= Seq(
  "org.wartremover" %% "wartremover" % "3.1.6" % "compile->compile"
)
```

## Best Practices

1. **Use dependency locking** - Install sbt-dependency-lock for reproducibility
2. **Pin Scala version** - Be explicit about scalaVersion
3. **Document cross-compilation** - Note which Scala version your SBOM represents
4. **Resolve before generating** - Run `sbt update` before SBOM generation
5. **Separate test dependencies** - Use `% Test` scope appropriately
6. **Check for updates** - Use `sbt dependencyUpdates` with sbt-updates plugin

## Security Scanning

Use sbt-dependency-check for vulnerability scanning:

```scala
// project/plugins.sbt
addSbtPlugin("net.vonbuchholtz" % "sbt-dependency-check" % "5.1.0")
```

```bash
# Run vulnerability check
sbt dependencyCheck

# Generate report
sbt dependencyCheckReport
```

Combine with SBOM generation:

```yaml
- name: Security check
  run: sbt dependencyCheck

- name: Generate SBOM
  uses: sbomify/github-action@master
  env:
    LOCK_FILE: 'build.sbt'
    OUTPUT_FILE: 'sbom.cdx.json'
```

## Mill Build Tool

For projects using Mill instead of sbt:

```scala
// build.sc
import mill._
import mill.scalalib._

object myapp extends ScalaModule {
  def scalaVersion = "3.3.1"
  def ivyDeps = Agg(
    ivy"org.typelevel::cats-core:2.10.0",
    ivy"io.circe::circe-core:0.14.6"
  )
}
```

Mill has different tooling but similar SBOM approaches:

```bash
mill show myapp.ivyDepsTree
```

## Further Resources

For more SBOM tools and resources, see our [SBOM Resources]({{ site.url }}/resources/) page, which includes general SBOM utilities for generation, distribution, and analysis.
